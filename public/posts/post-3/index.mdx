---
title: 'Next.js 15ì—ì„œ Context APIë¥¼ í™œìš©í•œ ë‹¤í¬ ëª¨ë“œ êµ¬í˜„í•˜ê¸°(+Tailwind CSS)'
description: 'React Context APIì™€ localStorageë¥¼ í™œìš©í•´ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.'
date: '2025ë…„ 03ì›” 17ì¼'
thumbnail: '/images/thumbnail/3.png'
tags: ['Next.js']
---

import Callout from '@/components/Callout';

# ê³ ë ¤í•œ ì 

1. Context API: props ì—†ì´ ì „ì—­ ìƒíƒœë¡œ ë‹¤í¬ ëª¨ë“œ ê´€ë¦¬
2. window.matchMedia: ì‚¬ìš©ìê°€ ì„¤ì •í•œ ì‹œìŠ¤í…œ ì„¤ì • ë°˜ì˜
3. ê¹œë¹¡ì„ ë°©ì§€í•˜ê¸°: í˜ì´ì§€ ë¡œë“œ ì‹œ í…Œë§ˆê°€ ë³€ê²½ë˜ë©° ë°œìƒí•˜ëŠ” ê¹œë¹¡ì„(flash of unstyled content)ì„ ë°©ì§€

<br />

# ë‹¤í¬ ëª¨ë“œ êµ¬í˜„

## 1. `ThemeContext` ë° `ThemeProvider` ìƒì„±

<Callout>
  ğŸ’¡ useContext <br />
  ë¦¬ì•¡íŠ¸ì—ì„œ ì „ì—­ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ê³ , ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ ê°„ì— ë°ì´í„°ë¥¼ ì‰½ê²Œ ê³µìœ í•˜ê¸°
  ìœ„í•´ ì‚¬ìš©ë˜ëŠ” í›…. ThemeContext.Providerë¡œ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì—ê²Œ ê°’ì„ ì œê³µí•˜ì—¬
  ì‚¬ìš©í•œë‹¤.
</Callout>

### ì „ì²´ ì½”ë“œ

`ThemeContext.Provider`ì— `isDarkMode`, `toggleTheme` ê°’ì„ ë„˜ê²¨ì¤€ë‹¤.

```js {title="src/app/components/ThemeProvider.tsx"}
'use client';

import {
  createContext,
  ReactNode,
  useContext,
  useEffect,
  useState,
} from 'react';

const ThemeContext = createContext({
  isDarkMode: false,
  toggleTheme: () => {},
});

export const useTheme = () => useContext(ThemeContext);

interface ThemeProviderProps {
  children: ReactNode;
}

const ThemeProvider: React.FC<ThemeProviderProps> = ({ children }) => {
  const [isDarkMode, setIsDarkMode] = useState(false);
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    setMounted(true);

    const storedTheme = localStorage.getItem('theme');

    if (storedTheme) {
      setIsDarkMode(storedTheme === 'dark');
    } else {
      // ì‹œìŠ¤í…œ í…Œë§ˆ ì„ í˜¸ë„ í™•ì¸
      const prefersDark = window.matchMedia(
        '(prefers-color-scheme: dark)'
      ).matches;
      setIsDarkMode(prefersDark);
      localStorage.setItem('theme', prefersDark ? 'dark' : 'light');
    }
  }, []);

  useEffect(() => {
    if (!mounted) return;

    if (isDarkMode) {
      document.documentElement.classList.add('dark');
      localStorage.setItem('theme', 'dark');
    } else {
      document.documentElement.classList.remove('dark');
      localStorage.setItem('theme', 'light');
    }
  }, [isDarkMode, mounted]);

  const toggleTheme = () => {
    setIsDarkMode(!isDarkMode);
  };

  if (!mounted) {
    return null;
  }

  return (
    <ThemeContext.Provider value={{ isDarkMode, toggleTheme }}>
      {children}
    </ThemeContext.Provider>
  );
};

export default ThemeProvider;
```

### ì´ˆê¸° í…Œë§ˆ ì„¤ì •

```
useEffect(() => {
  setMounted(true);

  const storedTheme = localStorage.getItem('theme');

  if (storedTheme) {
    setIsDarkMode(storedTheme === 'dark');
  } else {
    const prefersDark = window.matchMedia(
      '(prefers-color-scheme: dark)'
    ).matches;
    setIsDarkMode(prefersDark);
    localStorage.setItem('theme', prefersDark ? 'dark' : 'light');
  }
}, []);
```

**window.matchMediaë¡œ ì‹œìŠ¤í…œ ì„ í˜¸ë„ í™•ì¸**

`storedTheme`ì€ localStorageì—ì„œ `theme`ë¼ëŠ” í‚¤ë¡œ ì €ì¥ëœ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤. ì´ ê°’ì€ ì‚¬ìš©ìê°€ ì´ì „ì— ì„ íƒí•œ í…Œë§ˆì´ë‹¤.
localStorageì— ì €ì¥ëœ `theme` ê°’ì´ ìˆìœ¼ë©´, ê·¸ ê°’ì— ë”°ë¼ ë‹¤í¬ ëª¨ë“œ ë˜ëŠ” ë¼ì´íŠ¸ ëª¨ë“œë¥¼ ì„¤ì •í•œë‹¤.
localStorageì— ì €ì¥ëœ `theme` ê°’ì´ ì—†ìœ¼ë©´, `window.matchMedia`ë¥¼ í†µí•´ ì‚¬ìš©ì ë¸Œë¼ìš°ì €ì˜ ê¸°ë³¸ ìƒ‰ìƒ ì„¤ì •ì„ í™•ì¸í•œë‹¤.
ë‚˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ í–ˆì§€ë§Œ, next-themesë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œë„ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” ëª¨ì–‘ì´ë‹¤.

<br />

<Callout>
  ğŸ’¡ window.matchMedia <br />
  ë¸Œë¼ìš°ì €ì—ì„œ CSS ë¯¸ë””ì–´ ì¿¼ë¦¬ë¥¼ JavaScriptë¡œ ë‹¤ë£° ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” API.
  prefers-color-schemeì„ ê°ì§€í•´, ì‚¬ìš©ìì˜ ì‹œìŠ¤í…œ í…Œë§ˆ ì„¤ì •(ë¼ì´íŠ¸/ë‹¤í¬ ëª¨ë“œ)ì„
  ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.
</Callout>

### í…Œë§ˆ ì ìš©

useEffectë¥¼ ì‚¬ìš©í•´ `isDarkMode` ìƒíƒœê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì‹¤í–‰ë˜ë„ë¡ í–ˆë‹¤.
í˜„ì¬ ì„ íƒëœ í…Œë§ˆë¥¼ localStorageì— ì €ì¥í•˜ì—¬ ë‹¤ìŒ ë°©ë¬¸ ì‹œì—ë„ ì‚¬ìš©ìì˜ ì„ íƒì„ ê¸°ì–µí•  ìˆ˜ ìˆë‹¤.

```
useEffect(() => {
  if (!mounted) return;

  if (isDarkMode) {
    document.documentElement.classList.add('dark');
    localStorage.setItem('theme', 'dark');
  } else {
    document.documentElement.classList.remove('dark');
    localStorage.setItem('theme', 'light');
  }
}, [isDarkMode, mounted]);
```

### í•˜ì´ë“œë ˆì´ì…˜ ë¬¸ì œ í•´ê²°(ì´ˆê¸° ê¹œë¹¡ì„ ë°©ì§€)

Next.jsì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” í•˜ì´ë“œë ˆì´ì…˜ ë¶ˆì¼ì¹˜ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ” ì½”ë“œì´ë‹¤.
mounted ìƒíƒœê°€ falseì¼ ë•ŒëŠ” nullì„ ë°˜í™˜í•¨ìœ¼ë¡œì¨ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ì´ ì™„ì „íˆ ì¤€ë¹„ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê³ , ê·¸ í›„ì— ì •í™•í•œ í…Œë§ˆë¥¼ ì ìš©í•˜ëŠ” ë°©ì‹ì´ë‹¤.

```
if (!mounted) {
  return null;
}
```

ë˜í•œ ë°”ë¡œ ìœ„ ì½”ë“œì—ì„œ, ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ ëœ í›„ì—ë§Œ DOMì„ ì¡°ì‘í•˜ë„ë¡ í•˜ì—¬ ì´ˆê¸° í˜ì´ì§€ ë¡œë“œ ì‹œ ë°œìƒí•  ìˆ˜ ìˆëŠ” í…Œë§ˆ ê¹œë¹¡ì„ í˜„ìƒì„ ë°©ì§€í•œë‹¤.

```
useEffect(() => {
  if (!mounted) return;
}, [isDarkMode, mounted]);
```

## 2. `ThemeContext` ì ìš©í•˜ê¸°

ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœìƒìœ„ ë ˆë²¨ì—ì„œ ThemeProviderë¥¼ ì ìš©í•œë‹¤.

```js {title="src/app/layout.tsx"}
import ThemeProvider from '@/context/ThemeProvider';

export default function App({ Component, pageProps }) {
  return (
    <ThemeProvider>
      <Component {...pageProps} />
    </ThemeProvider>
  );
}
```

## 3. ë‹¤í¬ ëª¨ë“œ í† ê¸€ ë²„íŠ¼ ë§Œë“¤ê¸°

`ThemeContext`ë¥¼ ì„¤ì •í–ˆìœ¼ë‹ˆ, ì´ì œ ì‚¬ìš©ìê°€ í…Œë§ˆë¥¼ ì „í™˜í•  ìˆ˜ ìˆëŠ” ë²„íŠ¼ì„ ë§Œë“¤ì–´ì¤€ë‹¤. useThemeì—ì„œ `isDarkMode`, `toggleTheme` ê°’ì„ ë°›ì•„ì™€ ì‚¬ìš©í•œë‹¤. ì•„ì´ì½˜ì€ lucide iconì„ ì‚¬ìš©í–ˆë‹¤.

```js {title="src/components/ThemeToggleButton.tsx"}
'use client';

import { Sun, Moon } from 'lucide-react';
import { useTheme } from './ThemeProvider';

interface ThemeToggleButtonProps {
  className?: string;
}

const ThemeToggleButton: React.FC<ThemeToggleButtonProps> = ({ className }) => {
  const { isDarkMode, toggleTheme } = useTheme();

  return (
    <button
      onClick={toggleTheme}
      className={`${className} p-[4px] text-sm rounded-md text-[var(--gray-02)] dark:text-[var(--gray-01-dark)] hover:text-[var(--primary)] hover:dark:text-[var(--primary-dark)] transition-all duration-300`}
      aria-label='Toggle Dark Mode'
    >
      {isDarkMode ? <Sun /> : <Moon />}
    </button>
  );
};

export default ThemeToggleButton;
```

**í† ê¸€ ë²„íŠ¼ headerì— ì ìš©í•˜ê¸°**

```js {title="src/components/Header.tsx"}
import { useTheme } from './ThemeProvider';
import ThemeToggleButton from './ThemeToggleButton';

const Header = () => {
  const { isDarkMode } = useTheme();

  return (
    <header>
      <ThemeToggleButton className='hidden sm:flex' />
    </header>
  );
};
export default Header;
```

## 4. ë‹¤í¬ ëª¨ë“œ ìŠ¤íƒ€ì¼ ì ìš©í•˜ê¸°(Tailwind CSS)

ë£¨íŠ¸ ê²½ë¡œì— ìˆëŠ” tailwind.config.ts íŒŒì¼ì— ë‹¤ìŒê³¼ ê°™ì´ ì ìš©í•œë‹¤.

```js {title="tailwind.config.ts"}
import type { Config } from 'tailwindcss';

export default {
  darkMode: 'class',
  // ë‚˜ë¨¸ì§€ ì„¤ì •...
} satisfies Config;
```

ì´ì œ classNameì— `dark: ì†ì„±`ì„ ì¶”ê°€í•˜ë©´ ë‹¤í¬ ëª¨ë“œ ìŠ¤íƒ€ì¼ì´ ì ìš©ëœë‹¤.

```
<div className="bg-white text-black dark:bg-gray-900 dark:text-white">
  ë‹¤í¬ ëª¨ë“œ ì ìš©
</div>
```

<br />

# ëŠë‚€ì 

1. Context API
   ì „ì—­ ìƒíƒœë¥¼ ê´€ë¦¬í•  ë•Œ zustandë‚˜ redux ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë§Œ ì‚¬ìš©í•´ ë´¤ì§€ Context APIë¥¼ ì‚¬ìš©í•´ ë³¼ ìƒê°ì€ ì˜ ì•ˆí•´ë´¤ë‹¤.
   ì´ë²ˆ ê¸°íšŒì— ì‚¬ìš©í•´ ë´„ìœ¼ë¡œì¨, ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ë„ Context API ë§Œìœ¼ë¡œ ì „ì—­ í…Œë§ˆë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ë‹¤. ë¸”ë¡œê·¸ ê°™ì€
   ì‘ì€ í”„ë¡œì íŠ¸ì—ì„œëŠ” Context APIê°€ Reduxë‚˜ ë‹¤ë¥¸ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë³´ë‹¤ ë” ê°„ê²°í•˜ê³  ì§ê´€ì ì¸ í•´ê²°ì±…ì´ ë  ìˆ˜ ìˆìŒì„ ëŠê¼ˆë‹¤.
2. App Routerì™€ 'use client' ì§€ì‹œì–´
   í•˜ì´ë“œë ˆì´ì…˜ ì—ëŸ¬ê°€ ë°œìƒí•˜ê³  í•´ê²°í•´ ê°€ë©´ì„œ, App Routerë¥¼ ì‚¬ìš©í•  ë•Œ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì™€ ì„œë²„ ì»´í¬ë„ŒíŠ¸ë¥¼ ëª…í™•íˆ êµ¬ë¶„í•´ì•¼ í•œë‹¤ëŠ” ì ì„ ë°°ì› ë‹¤.
   í•˜ì§€ë§Œ ì•„ì§ê¹Œì§€ëŠ” ì–´ë µë‹¤.. Next docsë¥¼ ë”ìš± ê¼¼ê¼¼íˆ ì½ì–´ì•¼ê² ë‹¤.

<br />

# ì°¸ê³ 

- https://tailwindcss.com/docs/dark-mode
- https://ko.react.dev/reference/react/useContext
